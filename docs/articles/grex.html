<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gene ID Mapping for Genotype-Tissue Expression (GTEx) Data • grex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Gene ID Mapping for Genotype-Tissue Expression (GTEx) Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/grex.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nanxstats/grex">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Gene ID Mapping for Genotype-Tissue Expression (GTEx) Data</h1>
                        <h4 class="author">Nan Xiao &lt;<a href="https://nanx.me" class="uri">https://nanx.me</a>&gt;<br> Gao Wang &lt;<a href="https://home.uchicago.edu/gaow/" class="uri">https://home.uchicago.edu/gaow/</a>&gt;<br> Lei Sun &lt;<a href="mailto:sunl@uchicago.edu" class="email">sunl@uchicago.edu</a>&gt;</h4>
            
            <h4 class="date">2019-05-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanxstats/grex/blob/master/vignettes/grex.Rmd"><code>vignettes/grex.Rmd</code></a></small>
      <div class="hidden name"><code>grex.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The Genotype-Tissue Expression (GTEx) project <span class="citation">(Lonsdale et al. 2013)</span> aims at measuring human tissue-specific gene expression levels. With the collected data, we will be able to explore the landscape of gene expression, gene regulation, and their deep connections with genetic variations.</p>
<p>Raw GTEx data contains expression measurements from various types of elements (such as genes, pseudogenes, noncoding DNA sequences) covering the whole genome. For some analysis, it might be desirable to only keep a subset of the data, for example, data from protein coding genes. In such cases, mapping the original Ensembl gene IDs to Entrez gene IDs or HGNC symbols become an essential step in the analysis pipeline.</p>
<p><code>grex</code> offers a <strong>minimal dependency</strong> solution to do such ID mappings. Currently, an Ensembl ID from GTEx can be mapped to its Entrez gene ID, HGNC gene symbol, and UniProt ID, with basic annotation information such as HGNC gene name, cytogenetic location, and gene type. We also limit our scope on the Ensembl IDs appeared in the gene read count data. Ensembl IDs from transcript data will be considered in future versions.</p>
</div>
<div id="mapping-table" class="section level1">
<h1 class="hasAnchor">
<a href="#mapping-table" class="anchor"></a>Mapping Table</h1>
<p>To facilitate such ID conversion tasks, the <code>grex</code> package has a built-in mapping table derived from the well-known annotation data package <code>org.Hs.eg.db</code> <span class="citation">(Carlson 2015)</span>. The mapping data we used has integrated mapping information from Ensembl and NCBI, to maximize the possibility of finding a matched Entrez ID. The R script for creating the mapping table is located <a href="https://github.com/nanxstats/grex/blob/master/data-raw/mapping-table-generator.R">here</a>.</p>
<p>Not surprisingly, when creating such a table, there were hundreds of cases where a single Ensembl ID can be mapped to multiple Entrez gene IDs. To create a one-to-one mapping, we took a simple approach: we just removed the duplicated Entrez IDs and only kept the first we encountered in the original database. Therefore, there might be cases where the mapping is not 100% accurate. If you have such doubts for particular results, please try searching the original ID on the Ensembl website and see if we got a correct mapped ID.</p>
</div>
<div id="code-example" class="section level1">
<h1 class="hasAnchor">
<a href="#code-example" class="anchor"></a>Code Example</h1>
<p>As an example, we use the Ensembl IDs from GTEx V7 gene count data and select 100 IDs:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"grex"</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"gtexv7"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">id &lt;-<span class="st"> </span>gtexv7[<span class="dv">101</span><span class="op">:</span><span class="dv">200</span>]</a>
<a class="sourceLine" id="cb1-4" title="4">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/grex.html">grex</a></span>(id)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(df)</a></code></pre></div>
<pre><code>##          ensembl_id entrez_id hgnc_symbol                                   hgnc_name
## 95  ENSG00000266075      &lt;NA&gt;        &lt;NA&gt;                                        &lt;NA&gt;
## 96  ENSG00000272153      &lt;NA&gt;        &lt;NA&gt;                                        &lt;NA&gt;
## 97  ENSG00000116198      9731      CEP104                     centrosomal protein 104
## 98  ENSG00000169598      1677        DFFB       DNA fragmentation factor subunit beta
## 99  ENSG00000198912    339448    C1orf174         chromosome 1 open reading frame 174
## 100 ENSG00000236423 100133612   LINC01134 long intergenic non-protein coding RNA 1134
##     cyto_loc uniprot_id   gene_biotype
## 95      &lt;NA&gt;       &lt;NA&gt;           &lt;NA&gt;
## 96      &lt;NA&gt;       &lt;NA&gt;           &lt;NA&gt;
## 97   1p36.32     O60308 protein_coding
## 98   1p36.32     B4DZS0 protein_coding
## 99   1p36.32     Q8IYL3 protein_coding
## 100  1p36.32       &lt;NA&gt;        lincRNA</code></pre>
<p>The elements which cannot be mapped accurately will be <code>NA</code>.</p>
<p>Genes with a mapped Entrez ID:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">filtered_genes &lt;-</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span>df[</a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(df<span class="op">$</span><span class="st">"entrez_id"</span>),</a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ensembl_id"</span>, <span class="st">"entrez_id"</span>, <span class="st">"hgnc_symbol"</span>, <span class="st">"gene_biotype"</span>)</a>
<a class="sourceLine" id="cb3-5" title="5">  ]</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(filtered_genes)</a></code></pre></div>
<pre><code>##        ensembl_id entrez_id hgnc_symbol         gene_biotype
## 1 ENSG00000162576     54587       MXRA8       protein_coding
## 2 ENSG00000175756     54998    AURKAIP1       protein_coding
## 4 ENSG00000221978     81669       CCNL2       protein_coding
## 5 ENSG00000224870    148413  MRPL20-AS1 processed_transcript
## 6 ENSG00000242485     55052      MRPL20       protein_coding
## 8 ENSG00000235098    441869     ANKRD65       protein_coding</code></pre>
<p>If you want to start from the raw GENCODE gene IDs provided by GTEx (e.g. <code>ENSG00000227232.4</code>), the function <code><a href="../reference/cleanid.html">cleanid()</a></code> can help you remove the <code>.version</code> part in them, to produce Ensembl IDs.</p>
</div>
<div id="whats-next" class="section level1">
<h1 class="hasAnchor">
<a href="#whats-next" class="anchor"></a>What’s Next?</h1>
<p>Conventionally, the next step is removing (or imputing) the genes with <code>NA</code> IDs, and then select the genes to keep. Notably, as was observed in the complete gene read count data, in about 100 cases, multiple Ensembl IDs can be mapped to one single Entrez ID. Post-processing steps may also be needed for such genes.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>We thank members of the <a href="http://stephenslab.uchicago.edu">Stephens lab</a> (Kushal K Dey, Michael Turchin) for their valuable suggestions and helpful discussions on this problem.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-hsdb">
<p>Carlson, Marc. 2015. <em>org.Hs.eg.db: Genome Wide Annotation for Human</em>.</p>
</div>
<div id="ref-gtex">
<p>Lonsdale, John, Jeffrey Thomas, Mike Salvatore, Rebecca Phillips, Edmund Lo, Saboor Shad, Richard Hasz, et al. 2013. “The Genotype-Tissue Expression (GTEx) Project.” <em>Nature Genetics</em> 45 (6): 580–85.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#mapping-table">Mapping Table</a></li>
      <li><a href="#code-example">Code Example</a></li>
      <li><a href="#whats-next">What’s Next?</a></li>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan Xiao, Gao Wang, Lei Sun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
